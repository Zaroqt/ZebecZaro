<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TMA Social Feed</title>
    <!-- Tailwind CSS CDN for modern and responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons for aesthetic UI elements -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom styles for aesthetic enhancements and mobile layout */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        #app-container {
            width: 100%;
            max-width: 600px;
            padding: 16px;
        }
        .post-card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }
        .post-card:hover {
            transform: translateY(-2px);
        }
        .action-button {
            transition: all 0.15s;
            cursor: pointer;
        }
        .action-button:active {
            transform: scale(0.95);
        }
        .toast {
            z-index: 1000;
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            background-color: #ef4444; /* Red for errors like Permission Denied */
            color: white;
            border-radius: 8px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>

    <div id="app-container" class="space-y-4">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">TMA Feed</h1>

        <!-- Post Creation Form (Only visible to Admins) -->
        <div id="admin-post-form" class="hidden bg-white p-4 rounded-xl shadow-lg mb-6 border border-indigo-200">
            <h2 class="text-xl font-semibold mb-3 text-indigo-700">·Ä°·Äû·ÄÖ·Ä∫·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫</h2>
            <textarea id="post-input" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 mb-3" placeholder="·Äò·Ä¨·Äê·ÄΩ·Ä±·Äï·Äº·Ä±·Ä¨·ÄÅ·Äª·ÄÑ·Ä∫·Äï·Ä´·Äû·Äú·Ä≤..."></textarea>
            <button id="post-button" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition duration-150 shadow-md">Post ·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫</button>
        </div>

        <!-- Post List Container -->
        <div id="posts-container" class="space-y-4">
            <!-- Posts will be injected here by JavaScript -->
        </div>
        
        <!-- Loading Indicator -->
        <div id="loading-spinner" class="text-center p-8">
            <svg class="animate-spin h-8 w-8 text-indigo-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-gray-500 mt-2">Data ·Äô·Äª·Ä¨·Ä∏ ·ÄÅ·Ä±·Ä´·Ä∫·Äö·Ä∞·Äî·Ä±·Äû·Ää·Ä∫...</p>
        </div>
    </div>

    <!-- Toast/Notification Message Box -->
    <div id="toast" class="toast"></div>

    <!-- Firebase SDKs (v11.6.1 is used) -->
    <script type="module">
        // Firebase Modular SDK Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, updateDoc, deleteDoc, onSnapshot, collection, query, orderBy, where, writeBatch, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --------------------------------------------------------
        // FIREBASE CONFIGURATION (Hardcoded by User Request)
        // --------------------------------------------------------
        // Auth Token ·ÄÄ·Ä≠·ÄØ Canvas Environment ·ÄÄ·Äî·Ä± ·Ä°·Äú·Ä≠·ÄØ·Ä°·Äú·Äª·Ä±·Ä¨·ÄÄ·Ä∫ ·Äö·Ä∞·Äû·ÄØ·Ä∂·Ä∏·Äû·Ää·Ä∫
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        // üö® Config ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä§·Äî·Ä±·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ Hardcode ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äë·Ä¨·Ä∏·Äû·Ää·Ä∫ üö®
        const firebaseConfig = {
            apiKey: "AIzaSyDpuDVZXdT6CZ6MlgRAd8bbVYtuIVevzlI",
            authDomain: "zaroqt101.firebaseapp.com",
            projectId: "zaroqt101",
            storageBucket: "zaroqt101.firebasestorage.app",
            messagingSenderId: "141083314351",
            appId: "1:141083314351:web:e7f7ce068c0c2c34a7ec5a"
        };

        // üö® ·Ä§·Äî·Ä±·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·ÄÅ·ÄÑ·Ä∫·Äó·Äª·Ä¨·Ä∏·Åè Admin ID ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ Number ·Ä°·Äî·Ä±·Äñ·Äº·ÄÑ·Ä∑·Ä∫ ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äõ·Äï·Ä´·Äô·Ää·Ä∫·Åã
        // Firebase Rules ·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·ÄÄ·Ä≠·ÄØ·ÄÄ·Ä∫·Ää·ÄÆ·ÄÖ·Ä±·Äõ·Äî·Ä∫ ·Ä°·Äõ·Ä±·Ä∏·ÄÄ·Äº·ÄÆ·Ä∏·Äû·Ää·Ä∫
        const ADMIN_CHAT_IDS = [ 
            1924452453, // Admin 1: ·ÄÅ·ÄÑ·Ä∫·Äó·Äª·Ä¨·Ä∏·Åè ID (Number)
            6440295843, // Admin 2
            6513916873  // Admin 3
        ]; 

        // --------------------------------------------------------
        // FIREBASE SETUP AND INITIALIZATION
        // --------------------------------------------------------
        let db, auth, currentUserId = null, isAdminUser = false;
        const POSTS_COLLECTION = 'tma_zzfeed_posts';
        const LIKES_COLLECTION = 'tma_zzfeed_likes';

        // Helper function for showing toasts instead of alerts
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.backgroundColor = message.includes("Denied") ? '#ef4444' : '#10b981';
            toast.style.opacity = '1';
            setTimeout(() => {
                toast.style.opacity = '0';
            }, 3000);
        }

        // Helper function for displaying icons
        function getIcon(name, classes) {
            return `<i data-lucide="${name}" class="${classes}"></i>`;
        }
        
        // Convert timestamp to a readable format (e.g., "1 hour ago")
        function formatTimeAgo(timestamp) {
            if (!timestamp) return '·Äö·ÄÅ·ÄØ·Äú·Ä±·Ä∏·Äê·ÄÑ·Ä∫';
            const now = Date.now();
            const seconds = Math.floor((now - timestamp) / 1000);
            
            let interval = seconds / 31536000;
            if (interval > 1) return Math.floor(interval) + " ·Äî·Äæ·ÄÖ·Ä∫";
            interval = seconds / 2592000;
            if (interval > 1) return Math.floor(interval) + " ·Äú";
            interval = seconds / 86400;
            if (interval > 1) return Math.floor(interval) + " ·Äõ·ÄÄ·Ä∫";
            interval = seconds / 3600;
            if (interval > 1) return Math.floor(interval) + " ·Äî·Ä¨·Äõ·ÄÆ";
            interval = seconds / 60;
            if (interval > 1) return Math.floor(interval) + " ·Äô·Ä≠·Äî·ÄÖ·Ä∫";
            return "·Äö·ÄÅ·ÄØ·Äú·Ä±·Ä∏·Äê·ÄÑ·Ä∫";
        }

        // Initialize Firebase and Auth
        async function initializeFirebase() {
            if (!firebaseConfig.apiKey) {
                console.error("Firebase Config Not Found.");
                document.getElementById('loading-spinner').innerHTML = '<p class="text-red-500">Firebase Config ·ÄÄ·Ä≠·ÄØ ·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·ÄÖ·ÄΩ·Ä¨ ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äï·Ä´·Åã</p>';
                return;
            }

            try {
                // setLogLevel('debug'); // Enable for debugging Firestore rules/requests
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // Sign in using Custom Token or Anonymously
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                // Wait for auth state change to confirm user ID
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        currentUserId = user.uid;
                        // Check if the current user ID (string) is one of the Admin IDs (Number)
                        // JS stores IDs as strings, but ADMIN_CHAT_IDS are set as numbers for clarity in the array
                        isAdminUser = ADMIN_CHAT_IDS.includes(parseInt(currentUserId));
                        
                        console.log("Authenticated User ID:", currentUserId);
                        console.log("Is Admin:", isAdminUser);

                        // Show/Hide Admin Form based on permission
                        const adminForm = document.getElementById('admin-post-form');
                        if (adminForm) {
                            adminForm.classList.toggle('hidden', !isAdminUser);
                        }

                        // Start listening to data only after authentication is complete
                        listenForPosts();
                    } else {
                        // Handle sign-out or initial state
                        currentUserId = null;
                        document.getElementById('loading-spinner').innerHTML = '<p class="text-red-500">Firebase Authentication Failed.</p>';
                    }
                });

            } catch (error) {
                console.error("Firebase Initialization Error:", error);
                document.getElementById('loading-spinner').innerHTML = `<p class="text-red-500">Initialization Error: ${error.message}</p>`;
            }
        }

        // --------------------------------------------------------
        // DATA LOGIC (POSTS AND LIKES)
        // --------------------------------------------------------
        
        // Main function to listen for real-time post updates
        function listenForPosts() {
            if (!db) return; // Ensure DB is initialized
            
            const postsRef = collection(db, POSTS_COLLECTION);
            // Sort by timestamp descending. We will sort in memory to avoid index issues.
            const q = query(postsRef); 

            onSnapshot(q, (snapshot) => {
                const postsContainer = document.getElementById('posts-container');
                postsContainer.innerHTML = ''; // Clear previous content
                document.getElementById('loading-spinner').classList.add('hidden'); // Hide loading

                const allPosts = [];
                snapshot.forEach(doc => {
                    allPosts.push({ id: doc.id, ...doc.data() });
                });

                // Sort by timestamp in memory (descending)
                allPosts.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

                if (allPosts.length === 0) {
                    postsContainer.innerHTML = '<p class="text-center text-gray-500 p-8">·Äú·ÄÄ·Ä∫·Äõ·Äæ·Ä≠·Äê·ÄΩ·ÄÑ·Ä∫ Post ·Äô·Äª·Ä¨·Ä∏ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´</p>';
                } else {
                    allPosts.forEach(post => {
                        postsContainer.appendChild(createPostElement(post));
                    });
                    // Refresh Lucide icons after rendering new content
                    lucide.createIcons();
                }
            }, (error) => {
                console.error("Error fetching posts:", error);
                showToast("Post ·Äô·Äª·Ä¨·Ä∏ ·ÄÅ·Ä±·Ä´·Ä∫·Äö·Ä∞·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫: " + error.message);
                document.getElementById('loading-spinner').classList.add('hidden');
            });
            
            // Start listening for likes concurrently
            listenForLikes();
        }

        // Store likes data globally for quick lookup
        let likesData = {}; // Format: { postId: { count: N, likedBy: [userId1, userId2, ...] } }

        function listenForLikes() {
            if (!db) return;
            
            const likesRef = collection(db, LIKES_COLLECTION);
            // Listen for all changes in the likes collection
            onSnapshot(likesRef, (snapshot) => {
                const newLikesData = {};
                
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const postId = data.postId;
                    const userId = data.userId;
                    
                    if (!newLikesData[postId]) {
                        newLikesData[postId] = { count: 0, likedBy: [] };
                    }
                    newLikesData[postId].count += 1;
                    newLikesData[postId].likedBy.push(userId);
                });
                
                likesData = newLikesData;
                // Update all post elements after receiving new like data
                updateAllPostsUI();
            }, (error) => {
                console.error("Error fetching likes:", error);
                showToast("Like Data ·Äô·Äª·Ä¨·Ä∏ ·ÄÅ·Ä±·Ä´·Ä∫·Äö·Ä∞·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫: " + error.message);
            });
        }
        
        // Function to re-render like counts and status on existing posts
        function updateAllPostsUI() {
            document.querySelectorAll('.post-card').forEach(card => {
                const postId = card.dataset.postId;
                const likeInfo = likesData[postId] || { count: 0, likedBy: [] };
                
                const likeCountEl = card.querySelector('.like-count');
                const likeButtonEl = card.querySelector('.like-button');
                
                if (likeCountEl) {
                    likeCountEl.textContent = likeInfo.count;
                }
                
                if (likeButtonEl) {
                    const isLiked = likeInfo.likedBy.includes(currentUserId);
                    likeButtonEl.innerHTML = getIcon(isLiked ? 'heart' : 'heart', isLiked ? 'w-5 h-5 fill-red-500 text-red-500' : 'w-5 h-5 text-gray-400');
                    likeButtonEl.classList.toggle('text-red-500', isLiked);
                }
            });
        }
        
        // Create the HTML element for a single post
        function createPostElement(post) {
            const likeInfo = likesData[post.id] || { count: 0, likedBy: [] };
            const isLiked = likeInfo.likedBy.includes(currentUserId);
            
            const postDiv = document.createElement('div');
            postDiv.className = 'post-card bg-white p-5 rounded-xl border border-gray-200';
            postDiv.dataset.postId = post.id;
            
            const formattedTime = formatTimeAgo(post.timestamp);
            
            // Check if the authorId matches any of the admin IDs (for display purposes)
            const isPostAuthorAdmin = ADMIN_CHAT_IDS.includes(parseInt(post.authorId));
            const authorText = isPostAuthorAdmin ? 
                `<span class="text-indigo-600 font-semibold flex items-center">${getIcon('star', 'w-4 h-4 mr-1 fill-yellow-400 text-yellow-400')} Admin</span>` : 
                `<span class="text-gray-500">User ${post.authorId.substring(0, 5)}...</span>`;

            postDiv.innerHTML = `
                <div class="flex justify-between items-start mb-3">
                    <div class="flex items-center space-x-2">
                        <!-- Avatar Placeholder -->
                        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold text-lg">
                            ${post.id.charAt(0).toUpperCase()}
                        </div>
                        <div>
                            ${authorText}
                            <p class="text-xs text-gray-400">${formattedTime} ·ÄÄ</p>
                        </div>
                    </div>
                    ${isAdminUser ? `<button class="delete-button text-sm text-red-500 hover:text-red-700 p-1 rounded transition duration-150 action-button" data-id="${post.id}">${getIcon('trash-2', 'w-4 h-4')}</button>` : ''}
                </div>
                <p class="text-gray-800 mb-4 whitespace-pre-wrap">${post.content}</p>
                
                <!-- Action Bar -->
                <div class="flex items-center space-x-6 border-t pt-3 mt-3">
                    <!-- Like Button -->
                    <button class="like-button flex items-center space-x-1 text-gray-600 hover:text-red-500 action-button" data-id="${post.id}">
                        ${getIcon(isLiked ? 'heart' : 'heart', isLiked ? 'w-5 h-5 fill-red-500 text-red-500' : 'w-5 h-5 text-gray-400')}
                        <span class="like-count font-medium text-sm">${likeInfo.count}</span>
                    </button>
                    <!-- User ID Display (MANDATORY for multi-user apps) -->
                    <p class="text-xs text-gray-400">Your ID: ${currentUserId}</p>
                </div>
            `;
            
            // Attach event listeners
            postDiv.querySelector('.like-button')?.addEventListener('click', () => toggleLike(post.id, isLiked));
            postDiv.querySelector('.delete-button')?.addEventListener('click', () => deletePost(post.id));

            return postDiv;
        }

        // --------------------------------------------------------
        // ACTIONS: POST, LIKE, DELETE
        // --------------------------------------------------------

        // Handle new post submission
        async function createPost() {
            const postInput = document.getElementById('post-input');
            const content = postInput.value.trim();
            const postButton = document.getElementById('post-button');

            if (!content) {
                showToast("Post ·Ä°·ÄÄ·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·Ä°·Äõ·Ä¨·ÄÄ·Ä≠·ÄØ ·Äñ·Äº·Ää·Ä∑·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´");
                return;
            }
            if (!currentUserId || !isAdminUser) {
                showToast("Admin Permission ·Äô·Äõ·Äæ·Ä≠·Äï·Ä´·Åä Post ·Äê·ÄÑ·Ä∫·Åç·Äô·Äõ·Äï·Ä´");
                return;
            }
            
            postButton.disabled = true;
            postButton.textContent = "·Äê·ÄÑ·Ä∫·Äî·Ä±·Äû·Ää·Ä∫...";

            const newPost = {
                content: content,
                authorId: currentUserId.toString(), // üö® Firebase Rule ·ÄÖ·ÄÖ·Ä∫·ÄÜ·Ä±·Ä∏·Äõ·Äî·Ä∫ String ·Ä°·Äî·Ä±·Äî·Ä≤·Ä∑ ·Äï·Ä≠·ÄØ·Ä∑·Äû·Ää·Ä∫
                timestamp: Date.now() // Use client timestamp for initial sorting/display
            };

            try {
                await addDoc(collection(db, POSTS_COLLECTION), newPost);
                showToast("Post ·Äê·ÄÑ·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äû·Ää·Ä∫!");
                postInput.value = '';
            } catch (error) {
                console.error("Post ·Äê·ÄÑ·Ä∫·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫:", error);
                // üö® ·Ä§·Äî·Ä±·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ PERMISSION DENIED error ·ÄÄ·Ä≠·ÄØ ·Äñ·Äô·Ä∫·Ä∏·Äô·Ä≠·Äï·Ä´·ÄÄ
                showToast(`Permission Denied! Check Firebase Security Rules and Admin ID.`);
            } finally {
                postButton.disabled = false;
                postButton.textContent = "Post ·Äê·ÄÑ·Ä∫·Äõ·Äî·Ä∫";
            }
        }
        
        // Handle like/unlike action
        async function toggleLike(postId, isLiked) {
            if (!currentUserId) {
                showToast("Like ·Äú·ÄØ·Äï·Ä∫·Äõ·Äî·Ä∫ Log In ·Äù·ÄÑ·Ä∫·Äë·Ä¨·Ä∏·Äñ·Ä≠·ÄØ·Ä∑ ·Äú·Ä≠·ÄØ·Äï·Ä´·Äê·Äö·Ä∫");
                return;
            }
            
            const likeDocRef = doc(db, LIKES_COLLECTION, `${postId}_${currentUserId}`);
            
            try {
                if (isLiked) {
                    // Unlike: Delete the like document
                    await deleteDoc(likeDocRef);
                } else {
                    // Like: Create a new like document
                    await setDoc(likeDocRef, { 
                        postId: postId, 
                        userId: currentUserId,
                        timestamp: Date.now()
                    });
                }
            } catch (error) {
                console.error("Like Action Error:", error);
                showToast("Like ·Äú·ÄØ·Äï·Ä∫·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫: " + error.message);
            }
        }

        // Handle post deletion
        async function deletePost(postId) {
            if (!isAdminUser) {
                showToast("Admin ·Äû·Ä¨·Äú·Äª·Äæ·ÄÑ·Ä∫ Post ·Äñ·Äª·ÄÄ·Ä∫·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äõ·Äæ·Ä≠·Äû·Ää·Ä∫");
                return;
            }
            
            // NOTE: Using a custom modal is required, but using standard confirm() for now
            if (confirm("·Äí·ÄÆ Post ·ÄÄ·Ä≠·ÄØ ·Äñ·Äª·ÄÄ·Ä∫·Äñ·Ä≠·ÄØ·Ä∑ ·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?")) { 
                const postDocRef = doc(db, POSTS_COLLECTION, postId);
                const batch = writeBatch(db);
                
                try {
                    // 1. Delete the post itself
                    batch.delete(postDocRef);

                    // 2. Find and delete all associated likes
                    const q = query(collection(db, LIKES_COLLECTION), where("postId", "==", postId));
                    const querySnapshot = await getDocs(q);
                    
                    querySnapshot.forEach((doc) => {
                        batch.delete(doc.ref);
                    });

                    await batch.commit();
                    showToast("Post ·Äñ·Äª·ÄÄ·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äû·Ää·Ä∫!");
                } catch (error) {
                    console.error("Delete Action Error:", error);
                    showToast("Post ·Äñ·Äª·ÄÄ·Ä∫·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫: " + error.message);
                }
            }
        }

        // --------------------------------------------------------
        // EVENT LISTENERS AND STARTUP
        // --------------------------------------------------------
        
        document.addEventListener('DOMContentLoaded', () => {
            initializeFirebase();
            document.getElementById('post-button')?.addEventListener('click', createPost);
        });

    </script>
</body>
</html>

